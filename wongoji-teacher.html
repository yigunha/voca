<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì›ê³ ì§€ - ì„ ìƒë‹˜</title>
    <link rel="stylesheet" href="wongoji/teacher-style.css">
</head>
<body>
    <div class="container">
        <!-- ë¡œê·¸ì¸ ì˜ì—­ -->
        <div class="login-area" id="loginArea">
            <h1>ğŸ ì„ ìƒë‹˜ ë¡œê·¸ì¸</h1>
            <div class="login-form">
                <label for="teacherName">ì„ ìƒë‹˜ ì´ë¦„:</label>
                <input type="text" id="teacherName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                
                <label for="teacherPassword">ë¹„ë°€ë²ˆí˜¸:</label>
                <input type="password" id="teacherPassword" placeholder="ë¹„ë°€ë²ˆí˜¸">
                
                <button id="loginBtn" class="login-btn">ë¡œê·¸ì¸</button>
            </div>
        </div>

        <!-- ì„ ìƒë‹˜ ì‘ì—… ì˜ì—­ -->
        <div class="teacher-area" id="teacherArea" style="display:none;">
            <div class="header">
                <h1>ğŸ“ í•™ìƒ ì›ê³  ê´€ë¦¬</h1>
                <div class="teacher-info">
                    <span id="currentTeacher"></span>
                    <button onclick="logout()" class="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
            </div>

            <!-- í•„í„° ë° ê²€ìƒ‰ -->
            <div class="filter-section">
                <label for="classFilter">ë°˜ ì„ íƒ:</label>
                <select id="classFilter">
                    <option value="all">ì „ì²´</option>
                    <option value="3A">3A</option>
                    <option value="3B">3B</option>
                    <option value="4A">4A</option>
                    <option value="4B">4B</option>
                </select>

                <label for="studentSearch">í•™ìƒ ê²€ìƒ‰:</label>
                <input type="text" id="studentSearch" placeholder="í•™ìƒ ì´ë¦„">

                <button onclick="loadManuscripts()" class="search-btn">ê²€ìƒ‰</button>
                <button onclick="loadManuscripts()" class="refresh-btn">ìƒˆë¡œê³ ì¹¨</button>
            </div>

            <!-- ì›ê³  ëª©ë¡ -->
            <div class="manuscripts-section">
                <h2>í•™ìƒ ì›ê³  ëª©ë¡</h2>
                <div id="manuscriptsList" class="manuscripts-list"></div>
            </div>

            <!-- ì›ê³  ìˆ˜ì • ëª¨ë‹¬ -->
            <div id="editModal" class="modal">
                <div class="modal-content-large">
                    <div class="modal-header">
                        <h2 id="editTitle">ì›ê³  ìˆ˜ì •</h2>
                        <button onclick="closeEditModal()" class="close-btn">âœ•</button>
                    </div>
                    
                    <!-- ì›ê³ ì§€ ì»¨í…Œì´ë„ˆ -->
                    <div class="manuscript-wrapper">
                        <div class="error-line-container">
                            <svg id="errorLineSvg" class="error-line-svg"></svg>
                        </div>
                        <div id="manuscriptPaper" class="manuscript-paper cols-20"></div>
                    </div>

                    <!-- ì•ˆë‚´ ì •ë³´ -->
                    <div class="edit-info">
                        <p>ğŸ’¡ í•™ìƒ ì¤„: ì½ê¸° ì „ìš© (ìˆ˜ì • ë¶ˆê°€)</p>
                        <p>ğŸ’¡ ì„ ìƒë‹˜ ì¤„: ì²¨ì‚­ ë‚´ìš© ì…ë ¥ (ë¹¨ê°„ ê¸€ì”¨)</p>
                        <p>ğŸ’¡ ë¹¨ê°„ì„ : Ctrl + í´ë¦­ìœ¼ë¡œ í•™ìƒ ì¤„ì— í‘œì‹œ</p>
                    </div>

                    <!-- ìˆ˜ì • ì»¨íŠ¸ë¡¤ -->
                    <div class="edit-controls">
                        <button onclick="saveModifiedText()" class="save-btn">ìˆ˜ì • ë‚´ìš© ì €ì¥</button>
                        <button onclick="copyStudentToTeacher()" class="copy-btn">í•™ìƒ ì›ë³¸ ë³µì‚¬</button>
                        <button onclick="clearTeacherPaper()" class="clear-btn">ìˆ˜ì •ë³¸ ì§€ìš°ê¸°</button>
                        <button onclick="clearErrorMarks()" class="clear-error-btn">ë¹¨ê°„ì„  ëª¨ë‘ ì§€ìš°ê¸°</button>
                        <button onclick="closeEditModal()" class="cancel-btn">ë‹«ê¸°</button>
                    </div>

                    <!-- ì…ë ¥ì°½ -->
                    <div class="input-box">
                        <span id="prevContent" class="prev-content"></span>
                        <input type="text" id="inputBox" placeholder="">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- WASM ë° ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
    <script type="module">
        // WASM ë¹Œë“œ í™•ì¸ ë° ë¡œë“œ
        async function loadApp() {
            try {
                console.log('Loading wongo-bridge.js...');
                
                // wongo-bridge.js ë¡œë“œ ë° ì „ì—­ìœ¼ë¡œ ë“±ë¡
                const bridgeModule = await import('./wongoji/wongo-bridge.js');
                window.initWongoApp = bridgeModule.initWongoApp;
                window.WongoApp = bridgeModule.WongoApp;
                
                console.log('Bridge loaded, loading teacher-app.js...');
                
                // teacher-app.js ë¡œë“œ
                await import('./wongoji/teacher-app.js');
                
                console.log('All modules loaded successfully');
            } catch (error) {
                console.error('ë¡œë”© ì‹¤íŒ¨:', error);
                document.body.innerHTML = `
                    <div style="padding: 50px; text-align: center; color: white; background: #1a1a1a; min-height: 100vh;">
                        <h1>âš ï¸ WASM ëª¨ë“ˆì´ ë¹Œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</h1>
                        <p style="margin: 20px 0;">ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ì£¼ì„¸ìš”:</p>
                        <pre style="background: #000; padding: 20px; border-radius: 5px; display: inline-block; text-align: left;">
wasm-pack build --target web --out-dir wongoji/pkg --release
                        </pre>
                        <p style="margin-top: 20px; color: #888;">
                            ë¹Œë“œ í›„ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.
                        </p>
                        <details style="margin-top: 20px; max-width: 600px; margin-left: auto; margin-right: auto;">
                            <summary style="cursor: pointer; color: #4CAF50;">ì—ëŸ¬ ìƒì„¸ ì •ë³´</summary>
                            <pre style="background: #000; padding: 20px; border-radius: 5px; text-align: left; margin-top: 10px; overflow-x: auto;">
${error.stack || error.message || error}
                            </pre>
                        </details>
                    </div>
                `;
            }
        }
        
        loadApp();
    </script>
</body>
</html>